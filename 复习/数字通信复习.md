## Introduction


Information source and input transducer  --> Source encoder --> Channel encoder --> Digital modulator --> Channel --> Digital demodulator --> Channel decoder --> Source decoder --> Output transducer --> Output signal


### Elements of digital communications

#### source encoder

+ Conversion between original message and digital signal
+ To efficiently represent information: (1) Reduce redundant information (2) Source coding, data compression

#### Channel encoder

+ To increase the reliability of transmission
+ Convert a digital sequence to another one
+ Encryption

将 k 个信息比特转为 n-bit 序列（code word），code rate：k/n

#### Digital modulator

+ Map binary sequences into waveforms suitable for transmission in channel
+ Binary modulation
+ M-ary modulation

#### Channel

+ Physical medium to carry signal from transmitter to receiver
	+ Wires (Electronic signals)
	+ Optical fiber (Modulated light beam)
	+ Underwater channel (Acoustic signals)
	+ Free space (Radio Visible light)
	+ Data storage media(Magnetic tape, magnetic disk, optic disk) 
+ Impairments in channel
	+ Additive degradations(Thermal noise, External noise and interference )
	+ Multiplicative degradations (Attenuation Phase and amplitude distortion multipath distortion)


#### Digital demodulator 


+ De-map channel corrupted waveforms to binary sequences (usually  coded symbols) 
+ Hard or soft demodulation 

#### Channel decoder

+ To recover information sequence from redundant signals Hard or soft  
+ decoding


### Channels

#### Wireline channels 

Widely used: Telephone network; Guided EM channel, Twisted-pair, Coaxial cable, Wave guide Distorted in amplitude and phase 
Corrupted by additive noise 
Cross-talk in twisted-pair


#### Fiber-optic channels

Very wide bandwidth 20THz or even larger 
Low attenuation For long distance, amplified or regenerated by repeaters 
Highly reliable photonic devices needed 
Widely used: Trunk transmission, WDM system DWDM system; Access network; FTTH


#### Wireless electromagnetic channels

Propagation media: Vacuum Air

EM energy is coupled to propagation media by antennas
For efficient radiation, antenna must be longer than 1/10 wavelength

Propagation modes of EM wave

Visible light channel: Visible light between 400 and 800 THz

Underwater acoustic channels EM wave can't propagate long distance, except extremely low frequency

Define basic pulse shape band-limited to W, Maximum ISI free transmission rate: 2W symbol/s, One of the pulse to achieve maximum rate: $g(t) = {{\sin (2\pi Wt)} \over {2\pi Wt}}$

卷积：$s(t) \otimes c(t) = \int_{ - \infty }^\infty  {c(\tau )s(t - \tau )} d\tau$

采样理论：$s(t) = \sum\limits_{n =  - \infty }^\infty  {s\left( {{n \over {2W}}} \right)} {{\sin \left( {2\pi W(t - n/(2W))} \right)} \over {2\pi W(t - n/(2W))}}$

信道容量：$C = W{\log _2}\left( {1 + {P \over {W{N_0}}}} \right) \;\;bit/s$，P 为平均发送能量，$N_0$ 为加性噪声的功率谱密度



## Deterministic and random signal  analysis


帕塞瓦尔定理：$\int_{ - \infty }^\infty  {x(t){y^*}(t)} dt = \int_{ - \infty }^\infty  {X(f){Y^*}(f)} df$

瑞利能量定理：$\int_{ - \infty }^\infty  {{{\left| {x(t)} \right|}^2}} dt = \int_{ - \infty }^\infty  {{{\left| {X(f)} \right|}^2}} df$

### Bandpass and Lowpass and Signals



通常情况下，信息信号是低频（基带）信号，而通信信道可用的频谱在较高的频带。

Any real, narrow band, and high frequency signal — called a bandpass signal —can be represented in terms of a complex low frequency signal, called the lowpass equivalent of the original bandpass signal.

**Bandpass 信号**： A real & narrow band signal，频谱集中于 $\pm {f_0}$ 中：$X(f) = 0,\left| {f \pm {f_0}} \right| > W$

**Narraow band**: bandwidth < 1% of carrier frequency

**Wide band**: bandwidth: 1% -10% of carrier frequency

所有的物理信号都是实信号，复信号只用于数学分析。

Fast time varying,  Spectral is narrow relative to $f_0$, High frequency

**Lowpass signal**：频谱在零频率周围：$X(f) = 0,\left| f \right| > W$

低通信号可以是实的，也可以是复的，也称为 **Baseband** 信号，Non-modulated 信号，Zero IF 信号

Slow time varying, No jump in phase and amplitude, Low frequency


Bandpass 信号（实信号）可以表示为等效低通信号 LPE（通常为复信号，也可以是实信号）

+ All physical realizable signals are real.
+ Complex signals are only for mathematical convenience
+ Possibility to work with lowpass equivalents of bandpass signal instead of directly working with them 
+ Lower sampling rate


实信号 x(t) 的带宽的定义如下：Smallest range of positive frequency such that X(f)=0 when |f| is outside this range，实信号的带宽是 one-half of its frequency support set

复信号的带宽也定义为 one-half of the entire range of frequencies over which the spectrum is nonzero (frequency support)

**正频谱和负频谱**
$$
{X_ + }(f) = \left\{ \matrix{
  X(f)\quad f > 0 \hfill \cr 
  {1 \over 2}X(0)\quad f = 0 \hfill \cr 
  0\quad f < 0 \hfill \cr}  \right.\quad \quad {X_ - }(f) = \left\{ \matrix{
  X(f)\quad f < 0 \hfill \cr 
  {1 \over 2}X(0)\quad f = 0 \hfill \cr 
  0\quad f > 0 \hfill \cr}  \right.
$$

对于实信号有 ${X_ - }(f) = X_ + ^*( - f)$，所以有
$$
X(f) = {X_ + }(f) + {X_ - }(f) = {X_ + }(f) + X_ + ^*( - f)
$$
$$
{\left| {X(f)} \right|^2} = {\left| {{X_ + }(f)} \right|^2} + {\left| {X_ + ^*( - f)} \right|^2}
$$

**For real signal, due to Hermitian symmetry in frequency domain**

实信号的频谱有 Hermitian symmetry $X(-f)=X^*(f)$.

Hermitian symmetry exists only for real signal, doesn't hold for complex signal

+ Negative frequency part is superfluous (Discard of negative frequency part will not lead to information loss for real signal)
+ Can only retain positive or negative spectrum
+ Real signal can be reconstructed from the information in positive (or negative) frequency only
+ Complex signal can't be reconstructed from the information in positive (or negative) frequency only (Why?)

Negative frequency has no physical meaning for either real or complex signal, It is only used for mathematical handling

单边带频谱有物理含义，双边带只有数学含义，频谱关系为 $2W_{SSB}=W_{DSB}$

对于实信号，定义分析信号（pre-envelop） $x_+(t)$ 的频域表示为正频谱 $X_+(f)=X(f)u_{-1}(f)$
$$
\eqalign{
  & {x_ + }(t) = {F^{ - 1}}\left[ {{X_ + }(f)} \right] = {F^{ - 1}}\left[ {X(f){u_{ - 1}}(f)} \right]  \cr 
  &  = x(t) \otimes \left( {{1 \over 2}\delta (t) + j{1 \over {2\pi t}}} \right) = {1 \over 2}x(t) + {j \over 2}\hat x(t) \cr}
$$

$\hat x(t)$ 为希尔伯特变换，希尔伯特变换为正频率引入 $-\pi/2$ 的相位偏移，为负频率引入 $\pi/2$ 的相位偏移。

Hilbert transform 并不能将数据从一个域转到另一个域（都位于时域），可以用于将实信号转为复信号。

> 注：${X_ - }(f) = X(f){u_{ - 1}}( - f)$

分析信号只包含原始信号的正频率部分，在时域中肯定为**复信号**，实部为实信号，虚部为希尔伯特变换后的信号，实部和虚部不独立。

希尔伯特变换在频率域为 $F\left[ {\hat x(t)} \right] =  - j{\mathop{\rm sgn}} (f)X(f)$

实信号的重构：$x(t) = 2{\mathop{\rm Re}\nolimits} \left[ {{x_ + }(t)} \right]$

 **Why analytic signal**

+ Analytic representation of a real signal facilitates many mathematical manipulations of the signal
+ Makes certain attributes of the signal more accessible
+ Facilitate the derivation of modulation and demodulation techniques.

> 给定 bandpass signal $x(t)=a\cos(2\pi f_0t+\theta)$，求解 analytic signal

首先 $x(t) = {1 \over 2}a{e^{j(2\pi {f_0}t + \theta )}} + {1 \over 2}a{e^{ - j(2\pi {f_0}t + \theta )}}$，$x_+(t)$ 只包含了正频率部分，可得
$$
{x_ + }(t) = {1 \over 2}a{e^{j(2\pi {f_0}t + \theta )}} = {1 \over 2}a\left( {\cos \left( {2\pi {f_0}t + \theta } \right) + j\sin \left( {2\pi {f_0}t + \theta } \right)} \right)
$$


------

希尔伯特变换的一些性质

+ if $x(t)=x(-t)$  then  $\hat x(t)=-\hat x(-t)$
+ if $x(t)=-x(-t)$ then $\hat x(t)=\hat x(-t)$
+ if $x(t)=\cos w_0 t$ then $\hat x(t)=\sin w_0t$
+ if $x(t)=\sin w_0t$  then $\hat x(t)=-\cos w_0 t$
+ $\hat {\hat x(t)} =  - x(t)$
+ $\int_{ - \infty }^\infty  {{x^2}(t)} dt = \int_{ - \infty }^\infty  {{{\hat x}^2}(t)} dt$
+ $\int_{ - \infty }^\infty  {x(t)\hat x(t)} dt = 0$​




>给定 analytic signal $y(t)=\frac{1}{2}ae^{j(2\pi f_0t+\theta)}$，求解原始信号

$$
x(t) = 2{\mathop{\rm Re}\nolimits} \left[ {y(t)} \right] = a\cos \left( {2\pi {f_0}t + \theta } \right)
$$

------

定义实信号 $x(t)$ 的 **lowpass equivalent**（complex envelope）$x_l(t)$ 为
$$
{X_l}(f) = 2{X_ + }(f + {f_0})
$$
将 $x_+(t)$ 转到频域中，频谱位于零附近。

Obviously, $x_l(t)$ is a lowpass signal, and generally complex. But *not must be complex*! In some special case, can be real
$$
{x_l}(t) = \left( {x(t) + j\hat x(t)} \right){e^{ - j2\pi {f_0}t}}
$$
$$
\eqalign{
  & X(f) = F\left[ {x(t)} \right] = F\left[ {{\mathop{\rm Re}\nolimits} \left( {{x_l}(t){e^{j2\pi {f_0}t}}} \right)} \right]  \cr 
  &  = F\left[ {{1 \over 2}\left( {{x_l}(t){e^{j2\pi {f_0}t}} + x_l^*(t){e^{ - j2\pi {f_0}t}}} \right)} \right]  \cr 
  &  = {1 \over 2}\left[ {{X_l}(f - {f_0}) + X_l^*( - f - {f_0})} \right] \cr}
$$

将等效低通信号 $x_l(t)$ 写成如下形式 ${x_l}(t) = {x_i}(t) + j{x_q}(t) = {r_x}(t){e^{j{\theta _x}(t)}}$，

其中 ${x_i}(t) = x(t)\cos 2\pi {f_0}t + \hat x(t)\sin 2\pi {f_0}t\quad {x_q}(t) = \hat x(t)\cos 2\pi {f_0}t - x(t)\sin 2\pi {f_0t}$，有
$$
x(t) = {\mathop{\rm Re}\nolimits} \left[ {{r_x}(t){e^{j(2\pi {f_0}t + {\theta _x}(t))}}} \right] = {r_x}(t)\cos \left( {2\pi {f_0}t + {\theta _x}(t)} \right)
$$

带通信号和等效低通信号通过载波频率联系起来

modulation：${x_l}(t) \to x(t) = {\mathop{\rm Re}\nolimits} \left[ {{x_l}(t){e^{j2\pi {f_0}t}}} \right]$

demodulation：$x(t) \to {x_l}(t) = \left( {x(t) + j\hat x(t)} \right){e^{ - j2\pi {f_0}t}}$

>给定实窄带信号 $x(t) = a(t)\cos \left( {2\pi {f_0}t + {\theta _x}(t)} \right)$，求解等效低通

因为 $x(t) = {\mathop{\rm Re}\nolimits} \left[ {a(t){e^{j\left( {2\pi {f_0}t + {\theta _x}(t)} \right)}}} \right]$，根据上面的 modulation 关系可以得到等效低通为 ${x_l}(t) = a(t){e^{j{\theta _x}(t)}}$

---

>给定信号 $x(t)=\sqrt \varepsilon \phi(t) \cos(wt)$，求等效低通信号

因为 $x(t) = {\mathop{\rm Re}\nolimits} \left( {\sqrt \varepsilon  \phi (t){e^{ - jwt}}} \right)$，所以有 $x_l(t)=\sqrt \varepsilon \phi(t)$

------

**复信号的能量：**${\varepsilon _s} = \int_{ - \infty }^\infty  {{{\left| {s(t)} \right|}^2}} dt = \int_{ - \infty }^\infty  {{{\left| {S(f)} \right|}^2}} df$

带通信号的能量是分析信号能量的两倍
$$
\eqalign{
  & {\varepsilon _x} = \int_{ - \infty }^\infty  {{{\left| {x(t)} \right|}^2}} dt = \int_{ - \infty }^\infty  {{{\left| {X(f)} \right|}^2}} df = \int_{ - \infty }^\infty  {{{\left| {{X_ + }(f) + {X_ - }(f)} \right|}^2}} df  \cr 
  &  = \int_{ - \infty }^\infty  {{{\left| {{X_ + }(f)} \right|}^2}} df + \int_{ - \infty }^\infty  {{{\left| {{X_ - }(f)} \right|}^2}} df = 2\int_{ - \infty }^\infty  {{{\left| {{X_ + }(f)} \right|}^2}} df = 2{\varepsilon _{{x_ + }}} \cr} 
$$

而<u>等效低通信号的能量是带通信号的两倍</u>
$$
{\varepsilon _x} = 2\int_{ - \infty }^\infty  {{{\left| {{X_ + }(f)} \right|}^2}} df = 2\int_{ - \infty }^\infty  {{{\left| {{{{X_l}(f)} \over 2}} \right|}^2}} df = {1 \over 2}{\varepsilon _{{x_l}}}
$$

两个信号的**内积**为
$$
\left\langle {x(t),y(t)} \right\rangle  = \int_{ - \infty }^\infty  {x(t){y^*}(t)} dt = \int_{ - \infty }^\infty  {X(f){Y^*}(f)} df = \left\langle {X(f),Y(f)} \right\rangle
$$

一般两个信号的内积是复数，但是对于 bandpass 信号，内积为实数。
$$
\left\langle {x(t),y(t)} \right\rangle  = \left\langle {X(f),Y(f)} \right\rangle  = {1 \over 2}{\mathop{\rm Re}\nolimits} \left[ {\left\langle {{x_l}(t),{y_l}(t)} \right\rangle } \right]
$$
$$
{\varepsilon _x} = \left\langle {x(t),x(t)} \right\rangle  = \left\langle {X(f),X(f)} \right\rangle  = {1 \over 2}{\mathop{\rm Re}\nolimits} \left[ {\left\langle {{x_l}(t),{x_l}(t)} \right\rangle } \right] = {1 \over 2}{\varepsilon _{{x_l}}}
$$

> [!NOTE]
>
> 如果题目给出的等效低通信号的波形图，在计算发射信号能量时需要额外乘上 1/2

**互相关系数**
$$
{\rho _{x,y}} = {{\left\langle {x(t),y(t)} \right\rangle } \over {\sqrt {{\varepsilon _x}{\varepsilon _y}} }}
$$

bandpass 信号与 LPE 信号的互相关系数之间的关系：${\rho _{x,y}} = {\mathop{\rm Re}\nolimits} \left( {{\rho _{{x_l},{y_l}}}} \right)$

> [!NOTE]
>
> 对于带通信号，只要等效低通信号 $\left\langle {x_l(t),y_l(t)} \right\rangle$ 的实部为 0，这两个信号正交

互相关系数为 0 表示两个信号正交，等效低通信号正交表示带通信号正交，但是带通信号正交不能得到等效低通信号正交。

x,y 相互独立可得到 $\rho_{x,y}=0$，但**不能**得到 $\rho_{x_l,y_l}=0$


**带通信号的等效低通**

h(t) 为带通信号，等效低通记为 $h_l(t)$，有 $h(t) = {\mathop{\rm Re}\nolimits} \left[ {{h_l}(t){e^{j2\pi {f_0}t}}} \right]$，通过带通信号 x(t) 通过冲激响应为 h(t) 的带通系统，显然其输出为带通信号 y(t)，存在下面关系
$$
Y(f) = X(f)H(f)
$$
因此有
$$
\eqalign{
  & {Y_l}(f) = 2Y(f + {f_0}){u_{ - 1}}(f + {f_0}) = 2X(f + {f_0})H(f + {f_0}){u_{ - 1}}(f + {f_0})  \cr 
  &  = {1 \over 2}\left[ {2X(f + {f_0}){u_{ - 1}}(f + {f_0})} \right]\left[ {2H(f + {f_0}){u_{ - 1}}(f + {f_0})} \right] = {1 \over 2}{X_l}(f){H_l}(f) \cr}
$$
在时间域上有 ${y_l}(t) = {1 \over 2}{x_l}(t)*{h_l}(t)$



### Signal Space Representation of Waveforms

Norm：$\left\| v \right\| = \sqrt {\sum\limits_{i = 1}^n {{{\left| {{v_i}} \right|}^2}} }$​

标准信号集 $\phi_n(t)$ 和低通信号集 $\phi_{nl}(t)$ 的关系：${\phi _n}(t) = \sqrt 2 {\mathop{\rm Re}\nolimits} \left[ {{\phi _{nl}}(t){e^{j2\pi {f_0}t}}} \right]$

其中 $\sqrt 2$ 是为了归一化能量，具体原因如下：

令 $\phi_{nl}(t)=a(t)+jb(t)$，且 $\int_{ - \infty }^\infty  {{a^2}(t) + {b^2}(t)} dt = 1$

$$
\eqalign{
  & \int_{ - \infty }^\infty  {{{\left| {{\phi _n}(t)} \right|}^2}} dt = 2\int_{ - \infty }^\infty  {{{\left( {a(t)\cos 2\pi {f_0}t - b(t)\sin 2\pi {f_0}t} \right)}^2}} dt  \cr 
  &  = 2\int_{ - \infty }^\infty  {{a^2}(t){{\cos }^2}2\pi {f_0}t + {b^2}(t){{\sin }^2}2\pi {f_0}t} dt = 2 \times {1 \over 2}\int_{ - \infty }^\infty  {{a^2}(t) + {b^2}(t)} dt = 1 \cr} 
$$

上面用到了 $\int_{ - \infty }^\infty  {x(t)\cos 2\pi {f_0}t} dt = \int_{ - \infty }^\infty  {x(t)\sin 2\pi {f_0}t} dt = 0$

-----

$s_{ml}(t)=\sum_{n=1}^N s_{mnl} \phi_{nl}(t)$，${s_m}(t) = {\mathop{\rm Re}\nolimits} \left( {\left( {\sum\limits_{n = 1}^N {{s_{mnl}}} {\phi _{nl}}(t)} \right){e^{j2\pi {f_0}t}}} \right)$

则集 $\left\{ {{\phi _n}(t),{{\tilde \phi }_n}(t),n = 1, \cdots ,N} \right\}$ 中的（注意 ${{\tilde \phi }_n}(t) = j{\phi _n}(t)$）（如何从等效低通信号的正交基构造带通信号的正交基）
$$
{\phi _n}(t) = \sqrt 2 {\mathop{\rm Re}\nolimits} \left[ {{\phi _{nl}}(t){e^{j2\pi {f_0}t}}} \right]\quad {{\tilde \phi }_n}(t) =  - \sqrt 2 {\mathop{\rm Im}\nolimits} \left[ {{\phi _{nl}}(t){e^{j2\pi {f_0}t}}} \right]
$$
$$
\eqalign{
  & {s_m}(t) = {\mathop{\rm Re}\nolimits} \left( {\left( {\sum\limits_{n = 1}^N {{s_{mln}}} {\phi _{nl}}(t)} \right){e^{j2\pi {f_0}t}}} \right)  \cr 
  &  = \sum\limits_{n = 1}^N {{\mathop{\rm Re}\nolimits} \left[ {\left( {{s_{mln}}{\phi _{nl}}(t)} \right){e^{j2\pi {f_0}t}}} \right]}  = \sum\limits_{n = 1}^N {\left[ {{{s_{mln}^{(r)}} \over {\sqrt 2 }}{\phi _n}(t) + {{s_{mln}^{(i)}} \over {\sqrt 2 }}{{\tilde \phi }_n}(t)} \right]}  \cr}
$$


>基的完备性：基之间彼此正交，且单位能量。

如果只是需要为一组波形寻找一组基，可以不使用 Schmidt 正交化，直接根据时间区间进行分段，选择单元区间幅度为 1 作为基函数，即
$$
{\phi _i}(t) = \left\{ \matrix{
  1\quad i \le t \le i + 1 \hfill \cr 
  0\quad {\rm{otherwise}} \hfill \cr}  \right.
$$
然后直接写出波形对应的矢量即可（注意可能需要考虑这样写出的矢量组成的矩阵的秩是否与基的维度相等）


### Some useful random variables 



卡方分布用于描述多径问题，假设 $\left\{ {{X_i},i = 1, \cdots ,n} \right\}$ 是独立同分布的零均值且具有共同方差 $\sigma^2$ 的高斯随机变量，定义 $X = \sum\limits_{i = 1}^n {X_i^2}$，$E\left[ X \right] = n{\sigma ^2}\quad Var\left[ X \right] = 2n{\sigma ^4}$

Rayleigh 分布为两个 IID 高斯随机变量之和，且变量服从$N(0,{\sigma ^2})$ ：$X=\sqrt{X_1^2+X_2^2}$，方差越小，峰值越高

Rice 分布为两个 IID 高斯随机变量之和，变量方差相同但是均值（mean）不同。K （大概为均值除方差）越大，峰值越高。小 K 退化为Rayleigh，大 K 近似高斯分布，均值为 0 时退化为 Rayleigh 分布，大的均值近似高斯分布。

Rayleigh 和 Rice 常用于描述多径衰落信道接收的信号的统计特性（起伏性），另一种常用于描述多径衰落信道的是 Nakagami-m 分布，m 为衰落指数，m 越大表示衰落越不严重，同时 m 越大，PDF 峰值对应的点越向右，峰值也会越高（不绝对，m = 1/2 时的峰值会比 m = 9/16 时的峰值高）m= 1时退化为 Rayleigh 分布。

对数正态分布(Lognormal)适合对移动无线通信中信号阴影效应（the effect of shadowing of the signal due to large obstructions）进行建模，假设 $Y \sim N(m,{\sigma ^2})$，定义 $X=e^Y$，X 即为对数正态分布


### Limit theorems for sums of random variables

大数定律（law of large numbers）、中心极限定理（central limit theorem）：如果 $\{X_i, i=1,2,3,\cdots \}$ 表示一个 IID 随机变量序列，那么均值收敛于随机变量的平均值。

强大数定理（strong law of large numbers）表明，如果 $\{X_i,i=1,2,3,\cdots\}$ 是一个具有 $E[X_1]<\infty$ 的 IID 随机变量序列，则
$$
{1 \over n}\sum\limits_{i = 1}^n {{X_i}}  \to E\left[ {{X_1}} \right]
$$
中心极限定理（central limit theorem）表明，如果 $\{X_i,i=1,2,3,\cdots\}$ 是一个具有 $E[X_1]<\infty$ 且 ${\sigma ^2} = VAR\left[ {{X_1}} \right] < \infty$ 的 IID 随机变量序列，则

$$
{{{1 \over n}\sum\limits_{i = 1}^n {{X_i}}  - m} \over {\sigma /\sqrt n }} \to N(0,1)
$$

KL 分解：将随机过程投影到一组标准正交基（orthonormal basis）上，得到不相关的随机变量序列。



## Digital Modulation Schemes


**The goal of digital communications system**: To reliably transmit digital data to destination using the given communication channel.

**Problems encountered in digital communications**

+ Channel impairments
  + Noise 
  + Attenuation
  + Distortion
  + Interference
  + Fading
+ Limited spectrum 
  + Especially in wireless communications 

**Thus, a signal is needed that**

+ Represents the binary data stream
+ Matches the characteristics of the channel
+ Able to retrieve the binary stream from the signal
+ Bandwidth should match that of the channel
+ Able to resist the impairments caused by the channel

Bandpass signals are <u>**modulated**</u> signal

Baseband signals are <u>**modulating**</u> signal

### Representation of digitally modulated signals

假设调制器将 k 个比特映射为相应的信号波形集 $s_m(t)$，其中 $1\le m\le M, M=2^k$。假设每隔 $T_s$ 秒发送一次信号，则 $T_s$ 称为信号传输间隔，即每秒发送 ${R_s} = {1 \over {{T_s}}}$，$R_s$ 为信号速率或符号速率，而比特间隔 $T_b$ 为 ${{{T_s}} \over {{{\log }_2}M}}$，比特率 $R=R_s\log_2M$。

平均功率：${P_{avg}} = {{{\varepsilon _{bavg}}} \over {{T_b}}} = R{\varepsilon _{bavg}}$

传输带宽：由于 Nyquist 采样定理，$R_s=2B$，即 $B=R/(2\log_2M)$（该式只适用于一维信号空间）如果是多维信号空间，如 4-PSK 调制，请参见 [Bandwidth and dimension](#Bandwidth and dimension)

### Memoryless modulation methods

#### PAM

基带 PAM 信号波形表示为 $s_m(t)=A_mp(t)$，通常 $A_m$ 取离散值：$A_m=2m-1-M, \quad m=1,2,\cdots,M$，能量为 ${\varepsilon _{avg}} = {{\left( {{M^2} - 1} \right){\varepsilon _p}} \over 3}$。

对于带通 PAM 信号，其等效低通为 $A_mg(t)$​，因此有 
$$
{s_m}(t) = {\mathop{\rm Re}\nolimits} \left[ {{s_{ml}}(t){e^{j2\pi {f_c}t}}} \right] = {\mathop{\rm Re}\nolimits} \left[ {{A_m}g(t){e^{j2\pi {f_c}t}}} \right] = {A_m}g(t)\cos 2\pi {f_c}t
$$
其中 $f_c$ 是载波频率。取 $p(t)=g(t)\cos 2\pi f_c t$，能量为 ${\varepsilon _{avg}} = {{\left( {{M^2} - 1} \right){\varepsilon _g}} \over 6}$.

使用 $\phi (t) = {{p(t)} \over {\sqrt {{\varepsilon _p}} }}$ 作为一般 PAM 信号的基，$\phi (t) = \sqrt {{2 \over {{\varepsilon _g}}}} g(t)\cos 2\pi {f_c}t$ 作为带通 PAM 的基，利用这些基信号

$$
\eqalign{
  & {s_m}(t) = {A_m}\sqrt {{\varepsilon _p}} \phi (t)\quad ({\rm{baseband}})  \cr 
  & {s_m}(t) = {A_m}\sqrt {{{{\varepsilon _g}} \over 2}} \phi (t)\quad ({\rm{bandpass}}) \cr}
$$

经过调制的带通 PAM 信号是双边带（DSB）信号，传输时要求两倍的等效低通信号带宽，也可采用单边带（SSB），SSB 信号的带宽是 DSB 信号的一半。SSB PAM 的形式如下
$$
{s_m}(t) = {\mathop{\rm Re}\nolimits} \left[ {{A_m}\left( {g(t) \pm j\hat g(t)} \right){e^{j2\pi {f_c}t}}} \right]
$$
若 M=2，则 PAM 信号转为双极性（Antipodal）信号，又称二进制双极性信号。

PAM 的最小距离 ${d_{min}} = 2\sqrt {{\varepsilon _p}}  = \sqrt {2{\varepsilon _g}}  = \sqrt {{{12{{\log }_2}M} \over {{M^2} - 1}}{\varepsilon _{bavg}}}$

使用格雷编码幅度

#### Phase modulation 

带通信号表示为：
$$
{s_m}(t) = {\mathop{\rm Re}\nolimits} \left[ {g(t){e^{j{{2\pi (m - 1)} \over M}}}{e^{j2\pi {f_c}t}}} \right] = g(t)\cos {\theta _m}\cos 2\pi {f_c}t - g(t)\sin {\theta _m}\sin 2\pi {f_c t}
$$
平均能量为 ${\varepsilon _{avg}} = {\varepsilon _m} = {1 \over 2}{\varepsilon _g}$，假设基为
$$
{\phi _1}(t) = \sqrt {{2 \over {{\varepsilon _g}}}} g(t)\cos 2\pi {f_c}t\quad {\phi _2}(t) =  - \sqrt {{2 \over {{\varepsilon _g}}}} g(t)\sin 2\pi {f_c}
$$
则矢量表达式为 $\left[ {\sqrt {{{{\varepsilon _g}} \over 2}} \cos \left( {{{2\pi (m - 1)} \over M}} \right),\sqrt {{{{\varepsilon _g}} \over 2}} \sin \left( {{{2\pi (m - 1)} \over M}} \right)} \right]$。

最小距离为 ${d_{min}} = 2\sqrt {\left( {{{\sin }^2}\left( {{\pi  \over M}} \right) \times {{\log }_2}M} \right){\varepsilon _{bavg}}}  \approx 2\sqrt {{{{\pi ^2}{{\log }_2}M} \over {{M^2}}}{\varepsilon _{bavg}}}$

> [!WARNING]
>
> 若题目给出了信号的波形图，通过波形图计算的能量为 $\varepsilon_m$，那么等效低通信号能量为 $\varepsilon_g=2 \varepsilon_m$




#### Quadrature amplitude modulation 

将信息序列分成两个分离的 k 比特符号同时加在两个正交载波 $\cos 2\pi f_c t$ 和  $\sin 2\pi f_c t$ 上，则信号波形表示为
$$
{s_m}(t) = {\mathop{\rm Re}\nolimits} \left[ {\left( {{A_{mi}} + j{A_{mq}}} \right)g(t){e^{j2\pi {f_c}t}}} \right] = {A_{mi}}g(t)\cos 2\pi {f_c}t - {A_{mq}}g(t)\sin 2\pi {f_c}t
$$
矢量表示为 ${s_m} = \left[ {{A_{mi}}\sqrt {{\varepsilon _g}/2} ,{A_{mq}}\sqrt {{\varepsilon _g}/2} } \right]$，能量为 ${\varepsilon _m} = {\left\| {{s_m}} \right\|^2} = {{{\varepsilon _g}} \over 2}\left( {A_{mi}^2 + A_{mq}^2} \right)$

最小距离为 ${d_{min}} = \sqrt {{{\left\| {{s_m} - {s_n}} \right\|}^2}}  = \sqrt {2{\varepsilon _g}}  = \sqrt {{{6{{\log }_2}M} \over {M - 1}}{\varepsilon _{bavg}}}$

>QAM = PM(PSK) + PAM(ASK)     4-QAM=4-PSK

PAM 的信号空间是一维的，PM 和 QAM 是二维

QAM 信号波形可以看成组合幅度和相位的调制

#### Multidimensional signaling 

##### Orthogonal signaling

正交信号：等能量的正交信号集，能量为 $\varepsilon$，信号的基为 ${\phi _j}(t) = {{{s_j}(t)} \over {\sqrt \varepsilon  }}$，矢量表达式为
$$
{s_1} = \left( {\sqrt \varepsilon  ,0,0, \cdots ,0} \right)\quad {s_2} = \left( {0,\sqrt \varepsilon  ,0, \cdots ,0} \right)\quad  \cdots \quad {s_n} = \left( {0,0, \cdots ,0,\sqrt \varepsilon  } \right)
$$
则 $d_{min}=\sqrt {2\varepsilon}$，信号空间是 N 维。

##### Frequency shift keying

考虑正交信号：${s_m}(t) = {\mathop{\rm Re}\nolimits} \left[ {{s_{ml}}(t){e^{j2\pi {f_c}t}}} \right] = \sqrt {{{2\varepsilon } \over T}} \cos \left( {2\pi {f_c}t + 2\pi m\Delta ft} \right)$，等效低通：${s_{ml}}(t) = \sqrt {{{2\varepsilon } \over T}} {e^{j2\pi m\Delta ft}}$

FSK 为非线性调制方式，当且仅当 $sinc [2T(m-n)\Delta f]=0$ 时，信号正交，所以保持正交性的最小频率间隔为 $\Delta f=1/2T_s$（相干检测），信号空间多维度。

如果是非相干检测，则最小频率间隔为 $\Delta f=1/T_s$

##### Simplex signal

假设有一个 M 正交信号集，其等效的矢量表示为 $\{s_m\}$，均值为 $\bar s = {1 \over M}\sum\limits_{m = 1}^M {{s_m}}$，从每一个正交信号中减去均值得到 $s_m'=s_m-\bar s$。单纯信号的能量为 $\varepsilon (1-1/M)$，一对信号的互相关为 $-1/(M-1)$。单纯波形集是等相关的，而且需要的能量比正交波形集小，减小因子为 $1-1/M$。


>根据星座图求平均发射功率

直接计算每个点到原点的距离的平方，再求平均

------



## Optimal Receivers for AWGN Channels


### Waveform and vector channel models

AWGN 矢量信道的数学模型为 $r=s_m+n$，噪声服从 $N(0,N_0/2)$ 分布（功率谱密度为 $N_0/2$），PDF 为

$$
p(n) = {\left( {{1 \over {\sqrt {\pi {N_0}} }}} \right)^N}{e^{ - {{{{\left\| n \right\|}^2}} \over {{N_0}}}}}
$$
最佳检测为根据对 r 的观察，选取使 $P[s_m|r]$ 最大的消息 m 判决，即
$$
\hat m = \mathop {\arg \max }\limits_{1 \le m \le M} P\left[ {{s_m}|r} \right] = \mathop {\arg \max }\limits_{1 \le m \le M} {P_m}P\left[ {r|{s_m}} \right]
$$
上式为 MAP 判决，发送概率相等时 MAP 判决可以变成 ML 判决

$$
\hat m = \mathop {\arg \max }\limits_{1 \le m \le M} P\left[ {r|{s_m}} \right]
$$

$P_{e|m}$ 表示发送消息 m 时的差错概率（注意计算差错概率时需要乘上发送消息 m 的概率 $P_m$）

**充分统计量**：假设接收机的矢量 $r$ 以两个矢量 $r_1$ 和 $r_2$ 表示，进一步假设 $s_m$、$r_1$ 和 $r_2$ 组成一个马尔可夫链，即
$$
p\left( {{r_1},{r_2}|{s_m}} \right) = p\left( {{r_1}|{s_m}} \right)p({r_2}|{r_1})
$$
此时 $s_m$ 只与 $r_1$ 有关，所以可以只根据 $r_1$ 来进行检测，$r_1$ 便称为检测 $s_m$ 的充分统计量。

一个等式：$p({r_1},{r_2}|{s_1}) = {{p({r_1},{r_2},{s_1})} \over {p({s_1})}} = {{p({r_2}|{r_1},{s_1})p({r_1},{s_1})} \over {p({s_1})}} = p({r_2}|{r_1},{s_1})p({r_1}|{s_1})$

有时候需要对接收机接收到的信号进行预处理，即将可逆运算（invertible whitening operator）应用于接收矢量，再对处理后的接收矢量进行检测，这样并不影响接收机的最佳性能。

SER（symbol error probability） MER（message error probability）

### Waveform and vector AWGN channels


矢量 AWGN 信道的最佳检测（MAP dector）为

$$
\hat m = \mathop {\arg \max }\limits_{1 \le m \le M} \left[ {{{{N_0}} \over 2}\ln {P_m} - {1 \over 2}{\varepsilon _m} + r \cdot {s_m}} \right]
$$
在信号等概时，可以化简为

$$
\eqalign{
  & \hat m = \mathop {\arg \max }\limits_{1 \le m \le M} \left[ { - {1 \over 2}{\varepsilon _m} + r \cdot {s_m}} \right] = \mathop {\arg \min }\limits_{1 \le m \le M} \left[ {{1 \over 2}\left( {{{\left\| r \right\|}^2} + {{\left\| {{s_m}} \right\|}^2} - 2r \cdot {s_m}} \right)} \right]  \cr 
  &  = \mathop {\arg \min }\limits_{1 \le m \le M} \left[ {{1 \over 2}{{\left\| {r - {s_m}} \right\|}^2}} \right] = \mathop {\arg \min }\limits_{1 \le m \le M} \left[ {\left\| {r - {s_m}} \right\|} \right] \cr} 
$$

注意其中的 ${{{\left\| r \right\|}^2}}$ 对结果无影响，故可以直接添加（上面的的检测器称为最近邻（Nearest Neighbor）或者最小距离（Minimum-Distance））

令 $C(r,{s_m}) = 2r \cdot {s_m} - {\left\| {{s_m}} \right\|^2} = 2\int_{ - \infty }^\infty  {r(t){s_m}(t)} dt - \int_{ - \infty }^\infty  {s_m^2(t)} dt$，最佳检测表示为

$$
\hat m = \mathop {\arg \max }\limits_{1 \le m \le M} \left[ {{N_0}\ln {P_m} + C(r,{s_m})} \right]
$$
若信号等概且等能量，则最佳检测为
$$
\hat m = \mathop {\arg \max }\limits_{1 \le m \le M} r \cdot {s_m}
$$
该检测称为 envelope detector


令 $N_0  = 2\sigma^2$

等概（equiprobable）双极性二进制信号（antipodal signaling）的差错概率为 ${P_e} = Q\left( {\sqrt {2{\varepsilon _b}/{N_0}} } \right)$

等概二进制信号的差错概率为 ${P_e} = Q\left( {\sqrt {d_{12}^2/{2N_0}} } \right)$

正交二进制信号的差错概率为 ${P_e} = Q\left( {\sqrt {d^2/{2N_0}} } \right) = Q\left( {\sqrt {{\varepsilon _b}/{N_0}} } \right)$

这里的 $\varepsilon_b / N_0$ 为信噪比，所以等概双极性二进制信号的差错概率比正交二进制信号的差错概率更小，在同样差错概率的条件下，正交二进制信号传输的比特能量是双极性二进制信号传输的 2 倍，效率是双极性二进制信号传输的 1/2。

>MAP 可以使用 Matched fIlter 和 Correlator 实现

**匹配滤波器**：滤波器响应为 $h(t)=x(T-t)$，则有

$$
y(t) = r(t)*h(t) = \int_{ - \infty }^\infty  {r(\tau )h(t - \tau )} d\tau  = \int_{ - \infty }^\infty  {r(\tau )x(T - t + \tau )} d\tau 
$$
这里的 $x$ 为 $\phi(t)$ 或者 $s_m(t)$，相关器的输出 $r_x$ 可以通过匹配滤波器在 t=T 时刻（exactly at T）抽样得到。

假如噪声的功率谱密度为 ${{{N_0}} \over 2}$，经过匹配滤波器后的噪声的方差为

$$
Var\left[ {v(T)} \right] = {{{N_0}} \over 2}\int_{ - \infty }^\infty  {{{\left| {H(f)} \right|}^2}} df = {{{N_0}} \over 2}{\varepsilon _h}
$$

匹配滤波器的最大输出信噪比为 $2\varepsilon_s / N_0$

>[!WARNING]
>
>在设计匹配滤波器时，T 是一个任意值，在实践中，T 需要保证滤波器是因果的 (h(t)=0 for t < 0)

匹配滤波器用来获得接收信号的矢量表示，使用第 i 个基函数获得 $r_i$，之后接收信号的矢量进入判决阶段，与待选信息矢量做相关（Correlator），加上 $\eta_i$，选择最大的就是对应的信息。

一个等式：${\mathop{\rm Re}\nolimits} \left[ {{a_m}} \right] = {1 \over 2}\left( {{a_m} + a_m^*} \right)$

>已知一个信号为 ${s_0}(t) = A\quad 0 \le t \le T\quad {s_1}(t) = 0\quad 0 \le t \le T$，求其通过匹配滤波器的输出

首先求出基函数 $\phi (t) = {1 \over {\sqrt T }}\quad 0 \le t \le T$，则滤波器相应为 $h(t)=\phi(T-t)$，在 t=T 时刻对应的输出为
$$
{r_0} = \int_0^T {r(\tau )h(t - \tau )} dt = \int_0^T {A\phi (\tau )} d\tau  = \int_0^T {{A \over {\sqrt T }}} d\tau  = A\sqrt T 
$$
再加上噪声得到最后的输出
$$
\eqalign{
  & {r_0} = A\sqrt T  + n  \cr 
  & {r_1} = n \cr} 
$$
------

+ The relationship between correlator and matched filter
	+ Matched filtering is essentially correlation
	+ MF is a parallel implementation of correlator
	+ Hence, MF is much more complex than correlator
+ MF can maximize SNR at sampling instance
	+ Matched filter "projects" the r onto signal space spanned by $s_m$ ("matches" it)
	+ Reject the noise outside this space as irrelevant, maximize SNR, thus minimizing BER

Union bound：比较简单，在 SNR 较高时可以很好地符合，下面是 AWGN 信道的一般形式

$$
{P_e} \le {1 \over {2M}}\sum\limits_{m = 1}^M {\sum\limits_{1 \le m' \ne m \le M}^M {{e^{ - {{d_{mm'}^2} \over {4{N_0}}}}}} } 
$$

更加松散的条件
$$
{P_e} \le \left( {M - 1} \right)Q\left( {\sqrt {{{d_{min}^2} \over {2{N_0}}}} } \right) \le {{M - 1} \over 2}{e^{ - {{d_{min}^2} \over {4{N_0}}}}}
$$

差错概率的下边界和上边界

$$
{{{N_{min}}} \over M}Q\left( {\sqrt {{{d_{min}^2} \over {2{N_0}}}} } \right) \le {P_e} \le \left( {M - 1} \right)Q\left( {\sqrt {{{d_{min}^2} \over {2{N_0}}}} } \right)
$$

其中 $N_{min}$ 表示星座图上与至少一个点相距 $d_{min}$ 的点数。


>当在计算多变量的差错概率时，应该尽可能化成单个变量（只使用噪声作为变量，如噪声之间相加相减）的情况，方便处理。例如已知判决准则为 $r_1>r_2 \to s_1(t)$，$r_1<r_2 \to s_2(t)$，求解发送消息 1 的差错概率

已知发送消息 1 时的接收信号为 $r=(a+n_1, n_2)$，$n_1$ 和 $n_2$ 均为零均值高斯白噪声，方差为 $N_0/2$

$$
{P_e} = P({r_1} < {r_2}) = P({n_1} - {n_2} <  - a) = \int_{ - \infty }^{ - a} {{1 \over {\sqrt {2\pi {N_0}} }}{e^{ - {{{x^2}} \over {2{N_0}}}}}} dx = Q\left( {{a \over {\sqrt {{N_0}} }}} \right)
$$

注意 $n_1-n_2$ 的方差为 $N_0$

>[!NOTE]
>在计算差错概率时，尤其是判决域有三个或三个以上，且判决域是二维平面时，这个时候很容易出现判决域重合的情况，如果是 AWGN 信道，积分难以计算，并且重合区域对应的概率一般会很小，可能无需考虑

-----

### Optimal detection and error probability for band-limited signaling

注意误码率的基本公式为
$$
{P_e} = Q\left( {{{{d_{min}}} \over {\sqrt {2{N_0}} }}} \right)
$$

星座图上的一个点的误码率的公式为

$$
{P_{e|m}} \le {N_{{d_{min}}}}(m)Q\left( {\sqrt {{{d_{min}^2} \over {2{N_0}}}} } \right)
$$

$N_{d_{min}}(m)$ 为该点与其它点之间距离为 $d_{min}$ 的点的个数。


PAM 或 ASK 信号的差错概率分为内点和外点，其中内点的差错概率是外点的两倍。

$$
{P_e} = 2\left( {1 - {1 \over M}} \right)Q\left( {{{{d_{min}}} \over {\sqrt {2{N_0}} }}} \right) = 2\left( {1 - {1 \over M}} \right)Q\left( {\sqrt {{{6{{\log }_2}M} \over {{M^2} - 1}}{{{\varepsilon _{bavg}}} \over {{N_0}}}} } \right)
$$

对于带限信号，增大 M 能够提高带宽利用效率，但是会降低能量效率，性能会恶化。

PSK 信号检测差错概率为

$$
{P_e} \approx 2Q\left( {\sqrt {\left( {2{{\log }_2}M} \right){{\sin }^2}\left( {{\pi  \over M}} \right){{{\varepsilon _b}} \over {{N_0}}}} } \right) \approx 2Q\left( {\sqrt {{{2{\pi ^2}{{\log }_2}M} \over {{M^2}}}{{{\varepsilon _b}} \over {{N_0}}}} } \right)
$$

对于二进制相位调制，$s_1(t)$ 和 $s_2(t)$ 是双极性信号，差错概率 ${P_b} = Q\left( {\sqrt {{{2{\varepsilon _b}} \over {{N_0}}}} } \right)$。M = 4 的符号差错概率则为 ${P_e} = 1 - {P_c} = 1 - {\left( {1 - {P_b}} \right)^2}$

对于比特错误概率，由于 k 比特符号差错通常只包括单个比特差错，因此有 ${P_b} \approx {1 \over k}{P_e}$

QAM 信号检测差错概率为

$$
{P_{e,\sqrt M  - PAM}} = 2\left( {1 - {1 \over {\sqrt M }}} \right)Q\left( {{{{d_{min}}} \over {\sqrt {2{N_0}} }}} \right)
$$
$$
\eqalign{
  & {P_e} = 1 - {\left( {1 - {P_{e,\sqrt M  - PAM}}} \right)^2} = 2{P_{e,\sqrt M  - PAM}}\left( {1 - {1 \over 2}{P_{e,\sqrt M  - PAM}}} \right)  \cr 
  &  = 2 \cdot 2\left( {1 - {1 \over {\sqrt M }}} \right)Q\left( {\sqrt {{{3{{\log }_2}M} \over {M - 1}}{{{\varepsilon _{bavg}}} \over {{N_0}}}} } \right)\left( {1 - {1 \over 2}{P_{e,\sqrt M  - PAM}}} \right)  \cr 
  &  \le 4Q\left( {\sqrt {{{3{{\log }_2}M} \over {M - 1}}{{{\varepsilon _{bavg}}} \over {{N_0}}}} } \right) \cr} 
$$

+ For PAM and PSK, penalty for increasing the rate is 6 dB/bit
+ For QAM, penalty for increasing the rate is 3 dB/bit
+ QAM is more power efficient compared with PSK and PAM
+ But PSK has constant envelope

### Optimal detection and error probability for power-limited signals


对于功限信号，增大 M，能量效率提升，但是带宽效率下降


### Bandwidth and dimension

要重构带宽为 W 的信号，信号的抽样速率至少为每秒 2W 个样值，换言之，该信号具有每秒 2W 自由度（维度），所以，带宽为 W 且持续时间为 T 的信号的维度是 N=2WT（这一等式实际应为约等于）。

如果一个信号的信号集由 M 个信号组成，其每个信号的持续时间为 $T_s$，该信号集的带宽近似为 W，则该信号的维度为 $N=2WT_s$，进一步有（r 为带宽效率）

$$
W = {{{R_s}N} \over 2} = {{RN} \over {2{{\log }_2}M}} \Rightarrow r = {R \over W} = {{2{{\log }_2}M} \over N}
$$
一维调制方式（ASK 和 PAM）中，N=1 且 $r=2\log_2M$，因此可以作为单边带信号发送

二维信号传输方式（QAM 和 M-PSK），N=2 且 $r=\log_2M$，因此这些调制方式随着 M 的增大，带宽效率增大，这些系统适用于带宽受限且 r > 1 的情况，如电话和数字微波信道属于带限信道。

对于 M 元正交信号传输，N=M 且 $r=2\log_2M/M$，在这种情况下，带宽效率随 M 增大而下降。适合功率受限信道（deep space communication channel），该信道有充分大的带宽容纳大量信号。



## Digital Communication Through Band-limited Channels


Actually, channels are all band-limited

### Characterization of band-limited channels

对于带通信道上的信号 $s(t) = {\mathop{\rm Re}\nolimits} \left[ {v(t){e^{j2\pi {f_c}t}}} \right]$，等效低通的接收信号为
$$
r(t) = \int_{ - \infty }^\infty  {v(\tau )c(t - \tau )d\tau }  + z(t)
$$
或者 $R(f) = V(f)C(f) + Z(f)$

If the channel is band-limited to W, then $C(f)=0, |f|>W$，Frequency components in $V(f)$ for $|f|>W$ will not be passed by the channel

Within bandwidth of the channel: $C(f) = \left| {C(f)} \right|{e^{j\theta (f)}}$

Define envelope delay: $\tau (f) =  - {1 \over {2\pi }}{{d\theta (f)} \over {df}}$

Non-distorting or ideal channel: 在带宽内，幅度响应 $|C(f)|$ 是常数，包络延时为常数

Distortion in amplitude：在带宽内，幅度响应 $|C(f)|$ 不是常数

Distortion in delay：在带宽内，包络延时不是常数（相位向量 $\theta(f)$ 不是线性函数）

几种不同的数字调制技术有着相同的形式，即

$$
v(t) = \sum\limits_{n = 0}^\infty  {{I_n}g(t - nT)} 
$$

g(t) 是一个脉冲且具有带限，假设 g(t) 为
$$
g(t) = \left\{ \matrix{
  {1 \over {\sqrt T }}\quad 0 \le t \le T \hfill \cr 
  0\quad {\rm{otherwise}} \hfill \cr}  \right.
$$
这个信号经过信道传输后，假设信道为理想信道，即 $c(t)=\delta(t)$，则接收机的输入为
$$
{r_l}(t) = \sum\limits_{n = 0}^\infty  {{I_n}h(t - nT)}  + z(t)
$$
其中 $h(t) = \int_{ - \infty }^\infty  {g(\tau )c(t - \tau )} d\tau  = \int_{ - \infty }^\infty  {g(\tau )\delta (t - \tau )} d\tau  = g(t)$，然后 $r_l(t)$ 还会经过一个滤波器（匹配滤波器），以速率为 $1/T$ 符号每秒进行抽样，滤波器的输出为
$$
y(t) = \sum\limits_{n = 0}^\infty  {{I_n}x(t - nT)}  + v(t)
$$
其中（注意匹配滤波器 $h_m$ 对应的 T 与 g(t) 的 T 有关，这里的匹配滤波器可能并不是最优的，最优的可能是 $h_m(t)=g^*(-t)$，即 x(t) 为 h(t) 的自相关函数）
$$
x(t) = \int_{ - \infty }^\infty  {g(\tau ){h_m}(t - \tau )} d\tau  = \int_{ - \infty }^\infty  {g(\tau )g(T - t + \tau )} d\tau  = g(t) \otimes g(T - t)
$$
在 $t=kT+\tau_0$ 对输出进行抽样得到
$$
{y_k} = {I_k} + \sum\limits_{n = 0,n \ne k}^\infty  {{I_n}{x_{k - n}}}  + {v_k}
$$

对于 PAM 信号，用水平扫描速率 1/T 在垂直输入上显示接收信号 y(t)，所得到的示波器显示图形为眼图（用于观测符号间干扰和噪声的总量）。眼图纵轴体现峰值失真（peak distortion）和 Noise margin，横轴体现过零点失真（延时失真，Distortion of zero crossings）和 sensitivity to timing error，一般来说，眼图的“眼睛”张的越大，码间干扰越小，信号质量越好，存在噪声会使眼图轨迹模糊。最佳抽样时刻（optimum sampling time）应在“眼睛”张开最大的时刻。纵轴

无符号间干扰的条件是
$$
x(t = kT) \equiv {x_k} = \left\{ \matrix{
  1\quad k = 0 \hfill \cr 
  0\quad k \ne 0 \hfill \cr}  \right.
$$

奈奎斯特脉冲成形准则（Nyquist pulse-shaping criterion）或零 ISI 奈奎斯特条件（Nyquist condition for zero ISI）则给出了无符号间干扰的充要条件为
$$
\sum\limits_{m =  - \infty }^\infty  {X(f + m/T)}  = T
$$
即在 $\left[ {{k \over T} - W,{k \over T} + W} \right]$ 内频谱始终为 T。

无符号间干扰的带限信号的设计需要满足 $T>1/2W$，其中 T 为符号抽样间隔，W 为信道带宽。一种可以实现的脉冲频谱为 Raised cosine spectrum

$0\le\beta\le1$ 为 roll-off factor，$\beta=0$ 时为理想低通信号

**Excess bandwidth**: The bandwidth occupied by the signal beyond Nyquist frequency 1/2T, expressed as a percentage of the Nyquist frequency. $\beta=0.5$ , excess bandwidth is 50%, $\beta=1$, excess bandwidth is 100%

bandwidth of raised cosine is $W_{rc} = (1+\beta) / (2T_s)$

spectral efficiency is $\eta  = {{{R_s}} \over {{W_{rc}}}} = {2 \over {1 + \beta }}$

具有受控 ISI 的带限信号设计：可以放宽对 ISI 的限制（如允许采样点 `x[0]` 和 `x[1]` 都为 1，其它为0），$T=1/2W$ 时也能满足要求。



## Fading channels I: characterization and signaling



### Characterization of fading multipath channels



发送信号表示为 $s(t) = {\mathop{\rm Re}\nolimits} \left[ {{s_l}(t){e^{j2\pi {f_0}t}}} \right]$，假设存在多条传播路径，则接收到的带通信号为
$$
x(t) = \sum\limits_n {{\alpha _n}(t)s[t - {\tau _n}(t)]} 
$$
代入 s(t) 的表达式，可以得到等效低通接收信号为

$$
{r_l}(t) = \sum\limits_n {{\alpha _n}(t){e^{ - j2\pi {f_c}{\tau _n}(t)}}{s_l}[t - {\tau _n}(t)]} 
$$
因为 $r_l(t)$ 是等效低通信道对等效低通信号的响应，因此，等效低通信道可以用如下时变脉冲响应描述为

$$
{c_l}(t) = \sum\limits_n {{\alpha _n}(t){e^{ - j2\pi {f_c}{\tau _n}(t)}}\delta [\tau - {\tau _n}(t)]} 
$$
如果接收信号由连续多径分量组成，则时变脉冲响应为

$$
c(\tau ;t) = \alpha (\tau ;t){e^{ - j2\pi {f_c}\tau }}
$$

**等效低通**冲激响应 $c(\tau, t)$ 的自相关函数为 ${R_c}({\tau _2},{\tau _1};\Delta t)$，若 $\Delta t$ 为0，则自相关函数 $R_c(\tau)$ 就是信道平均功率输出，通常将其称为信道的多径强度分布（Multipath intensity profile）或延时功率谱（Delay power spectrum），自相关函数可以通过发送很窄的脉冲进行测量（或者某一宽带信号），使 $R_c(\tau)$ 非 0 的 $\tau$ 的范围称为**信道多径扩展**（multipath spread），记为 $T_m$。多径扩展的值与环境有关，Urban（市区） area smaller，suburban（郊区） area larger，多径扩展不会提供发射机和接收机的相对运动信息。rural（农村）地区的多径扩展比 urban 大。

>[!NOTE]
>信道多径扩展 $T_m$ 与符号速率 $T_s$ 之间的关系：符号交迭的比例为 $T_m / T$


$R_c(\tau)$ 可以理解为信道增益，因为

$$
\eqalign{
  & E\left\{ {{{\left| {{r_l}(t)} \right|}^2}} \right\} = E\left\{ {\int_{ - \infty }^\infty  {{c_l}({\tau _1},t){s_l}(t - {\tau _1})} d{\tau _1}\int_{ - \infty }^\infty  {{c_l}({\tau _2},t){s_l}(t - {\tau _2})} d{\tau _2}} \right\}  \cr 
  &  = \int_{ - \infty }^\infty  {\int_{ - \infty }^\infty  {E\left[ {{c_l}({\tau _1},t){c_l}({\tau _2},t)} \right]E\left[ {{s_l}(t - {\tau _2}){s_l}(t - {\tau _1})} \right]} d{\tau _2}} d{\tau _1}  \cr 
  &  = \int_{ - \infty }^\infty  {\int_{ - \infty }^\infty  {{R_{{c_l}}}({\tau _2} - {\tau _1})\delta ({\tau _2} - {\tau _1})E\left[ {{s_l}(t - {\tau _2}){s_l}(t - {\tau _1})} \right]} d{\tau _2}} d{\tau _1}  \cr 
  &  = \int_{ - \infty }^\infty  {{R_{{c_l}}}(\tau )E\left[ {s_l^2(t - \tau )} \right]} d\tau  \cr} 
$$

进行傅里叶变换可以得到 

$$
{R_c}({f_2},{f_1};\Delta t) = E\left[ {{C^*}({f_1};t)C({f_2};t + \Delta t)} \right] = {R_c}(\Delta f;\Delta t)
$$

令 $\Delta t=0$，$R_c(\Delta f)$ 提供了信道频率相干性的一种度量，多径扩展的倒数为信道 coherence bandwidth 的度量，即 ${\left( {\Delta f} \right)_c} \approx {1 \over {{T_m}}}$

${\left( {\Delta f} \right)_c}$ 表示相关带宽，频率间隔大于 ${\left( {\Delta f} \right)_c}$ 的两个正弦波受到信道的影响不同，当信息经过信道时，如果 ${\left( {\Delta f} \right)_c}$ 比发送信号带宽小，那么该信道为频率选择性信道，在这种情况下，信道使信号产生严重失真。如果 ${\left( {\Delta f} \right)_c}$ 比发送信号带宽大，那么该信道称为频率非选择性信道。

对于 ${R_c}(\Delta f;\Delta t)$ 中参数 $\Delta t$ 表示的信道时间变量，信道的时间变化表现为多普勒扩展，对 ${R_c}(\Delta f;\Delta t)$ 进行傅里叶变换得到 $S_c(\Delta f, \lambda)$。使 $S_c(\lambda)$ 为非 0 的 $\lambda$ （$\lambda$ 为多普勒频率）值的范围为信道多普勒扩展 $B_d$，$B_d$ 的倒数则为信道相干时间的度量，即 ${\left( {\Delta t} \right)_c} \approx {1 \over {{B_d}}}$，一个慢变化信道具有大的相干时间，或等效为小的多普勒扩展。如果 $R_c(\Delta t)$ 实不变，那么 $S_C(\lambda)$ 为冲激函数，即没有多普勒扩展。

>[!NOTE]
>$(\Delta t)_c$ 实际上为 $R_c(\Delta t)$ 不为 0 的范围，$(\Delta f)_c$ 实际上为 $R_c(\Delta f)$ 不为 0 的范围
>$R_c(\Delta f)$ 与 $R_c(\tau)$ 为一组傅里叶变换对，$R_c(\Delta t)$ 与 $S_c(\lambda)$ 为一组傅里叶变换对

对 $R_c(\tau, \Delta t)$ 进行傅里叶变换，得到信道散射函数 $S(\tau, \lambda)$，散射函数的多普勒扩展对应 3dB 带宽，并且每条信号路径的多普勒扩展不同，因此可以取各条路径的 3 dB 带宽的最大值作为多普勒扩展。


**Jakes 模型**

$R_c(\Delta t)$ 是时变传递函数 $C(f;t)$ 的自相关函数，即
$$
{R_c}(\Delta t) = E\left( {{C^*}(f;t)C(f;t + \Delta t)} \right) = {J_0}(2\pi {f_m}\Delta t)
$$
其中 $f_m=vf_0/c$，$f_m$ 为最大多普勒频率，v 为车速，$f_0$ 为载波频率，c 为光速。傅里叶变换为

$$
{S_c}(\lambda ) = \left\{ \matrix{
  {1 \over {\pi {f_m}}}{1 \over {\sqrt {1 - {{\left( {f/{f_m}} \right)}^2}} }}\quad \left| f \right| \le {f_m} \hfill \cr 
  0\quad \quad \quad \quad \left| f \right| > {f_m} \hfill \cr}  \right.
$$
$B_d=2f_m$

>以 3G 系统为例，载波频率为 2GHz，当速度为 360 km/h 时，求多普勒频率

$$
{f_d} = {{v{f_c}} \over c} = {{100 \times 2 \times {{10}^9}} \over {3 \times {{10}^8}}} = 666Hz
$$

---


### The effect of signal characteristics on the choice of a channel model

$W \ll {(\Delta f)_c}$ 且信号传输间隔 (signaling interval) $T \ll {(\Delta t)_c}$ 称为慢衰落（slow fading）信道。当 $W \approx 1/T$ 时，信道为频率非选择性和慢衰落信道，意味着 $T_m$ 和 $B_d$ 的乘积必须满足 $T_m B_d <1$


乘积 $T_m B_d$ 称为信道的扩展因子，若  $T_m B_d<1$，称信道欠扩展（underspread），否则为过扩展（overspread）。 

许多无线信道都是欠扩展的，因此可以选择信号 $S_l(f)$ 使得信道频率非选择性和慢衰落。

**Frequency-flat (frequency-nonselective) slow fading**

+ $W \le {\left( {\Delta f} \right)_c},T \le {\left( {\Delta t} \right)_c}$
+ No multipath ISI
+ Almost time invariant in one symbol interval

**Frequency-flat (frequency-nonselective) fast fading**

+ $W \le {\left( {\Delta f} \right)_c},T \ge {\left( {\Delta t} \right)_c}$
+ No multipath ISI

**Frequency-selective slow fading**

+ $W \ge {\left( {\Delta f} \right)_c},T \le {\left( {\Delta t} \right)_c}$

**Frequency-selective fast fading**

+ $W \ge {\left( {\Delta f} \right)_c},T \ge {\left( {\Delta t} \right)_c}$



### Diversity techniques for fading multipath channels

Supply to the receiver several replicas of the same information signal transmitted over independently fading channel to improve performance.

**Frequency diversity**: That is, the same information-bearing signal is transmitted on L carriers, where the separation between successive carriers equals or exceeds the coherence bandwidth $(\Delta f)_c$ of the channel. Signals with bandwidth W that $W \le (\Delta f)_c$ （分集数为 $W/(\Delta f)_c$）

**Time diversity**: A second method for achieving L independently fading versions of the same information-bearing signal is to transmit the signal in L different time slots, where the separation between successive time slots equals or exceeds the coherence time $(\Delta t)_c$ of the channel. More difficult to obtain time diversity in slow fading channel. time interval $\Delta T \ge (\Delta t)_c$，在慢衰落信道（$T \ll (\Delta t)_c$）中实现时间分集比较困难

**Space diversity**: Another commonly used method for achieving diversity employs multiple antennas. Antenna separation: usually at least 10 wavelengths. Transmit on several space directions

A more sophisticated method for obtaining diversity is based on the use of a signal having a bandwidth much greater than the coherence bandwidth $(\Delta f)_c$ of the channel. 带宽为 W 的信号将分辨多径分量，从而给接收机提供若干独立的衰落信号路径，时间分辨率为 $1/W$。因此，由于多径扩展为 $T_m$ 秒，所以有 $T_mW$ 个可分辨的信号分量。因为 ${T_m} \approx 1/{(\Delta f)_c}$，可分辨的信号分量数目也可表示为 $W/(\Delta f)_c$，于是宽带信号的使用可以看成阶数为 $L=W/(\Delta f)_c$ 的频率分集。

在分集技术中，假设
+ L diversity channels carrying the same information-bearing binary signal
+ Each channel is Frequency-nonselective slowly fading Rayleigh channel
+ Each channel is Independent to each other
+ Each channel is corrupted by iid AWGN

能量固定时，分集不是越多越好，分集越多，单条路径的能量越小，差错率便会升高（对于 M 元正交信号而言，M 的影响不太大）

>假设有 10kHz 的频率用于分配，希望该条信道的传输速率为 100b/s，设计一个具有分集的二进制通信系统

首先可以选择 4-FSK 进行调制，这样 $R_s=50 \; symbols/s$，$T_s=1/50$ s，为了实现信号正交，对应的频率间隔为 $1/T_s = 50\; Hz$，子信道（子频率）数为 $10000/50=200$。又因为需要 4 个频率来传输两个比特，所以可以达到 200 / 4 = 50 阶分集。

>某一多径衰落信道具有多径扩展 $T_m=1s$，以及多普勒扩展 $B_d=0.01Hz$，信号传输可用带宽为 5 Hz，为了减小符号间干扰影响，信号设计者选择脉冲持续时间 T=10s。假设在频率分集模型中，二进制数据通过（双极性）相干检测 PSK，以频率分集模式在信道上传输，如何利用信道带宽获得频率分集，以及可获得多大分集

由于脉冲持续时间 T=10s（采样速率为 0.1 Hz），所以二进制 PSK 信号的频率间距为 $1/T=0.1 Hz$，二进制 PSK 信号的带宽为 W=5Hz，所以一共可以形成 50 个子信道或者载波频率，另一方面，可获得的分集数为 $W/(\Delta f)_c=5$。假设数据速率为 1bit/s，十个相邻的载波可以被用于并行传输数据，数据被重复 5 次来实现 5 阶的频率分集。每个携带相同信息的载波之间的频率差为 1Hz 来实现独立的衰落。

---



### Signal over a frequency-selective, slowly fading channel: the RAKE demodulator



在频率非选择性和慢衰落信道中，分集技术可用来克服衰落的严重影响。

假设时不变信道和带限信号，考虑带宽为 W 的宽带实值带通信号，等效低通信号 $s_l(t)$ 的频带占用为 $|f|\le W/2$

$$
{r_l}(t) = \sum\limits_{n =  1 }^L  {{c_n}(t){s_l}\left( {t - {n \over W}} \right)} \quad {c_n}(t) = {1 \over W}c\left( {{n \over W};t} \right)
$$

抽头间隔（分辨率）为 $1/W$，信道抽头延时线模型可截断为 $L = \left\lfloor {{T_m}W} \right\rfloor  + 1$ 个抽头，$c(\tau, t)$ 为时变冲激响应。

>[!WARNING]
>L 还有另一种表达式 $L=W/(\Delta f)_c = WT_m$，如果该式能得到整数，用该式，否则向下截断再加 1



上面这一方程的含义为：对于接收到的信号，先得到等效低通信号 $s_l(t)$， 然后经过 L 次延时，每次延时 $1/W$ 后和一个系数 $c_n(t)$ 相乘，最后相加得到 $r_l(t)$。

零均值：$|c_n(t)|$ 是 Rayleigh，均值非0：$|c_n(t)|$ 是 Ricean，$\{c_n(t)\}$ 互不相干

如果信道是慢衰落，则可以实现相关接收。


**Rake 解调器**

当信号持续时间 T 满足条件 $T \gg T_m$ ，即 $(\Delta f)_c \gg W$ 时，可以忽略由多径引起的任何符号间干扰。

假设有 M 个信号待解调，则定义 M 个函数
$$
{v_{ml}} = \sum\limits_{k = 1}^L {{c_k}(t){s_{ml}}\left( {t - {k \over W}} \right)}  \quad m=1,2,\cdots,M 
$$
其中 L 为抽头数，则最终解调结果对应的 m 为

$$
\hat m = \mathop {\arg \max }\limits_{1 \le m \le M} {\mathop{\rm Re}\nolimits} \left[ {{r_l}(t)v_m^*(t)} \right] = \mathop {\arg \max }\limits_{1 \le m \le M} {\mathop{\rm Re}\nolimits} \left[ {\int_0^T {{r_l}(t)v_{ml}^*(t)} dt} \right]
$$



## Multiple-Antenna Systems

### Channel Models for Multiple-Antenna Systems

A communication system employing $N_T$ transmitting antennas and $N_R$ receving antennas is generally called a MIMO system.

$N_T=1, N_R=2$ 相当于双分集，同理 $N_T=1, N_R=3$ 相当于三分集。

我们将第 j 个发射天线和第 i 个接收天线之间等效低通信道冲激响应表示为 $h_{ij}(\tau, t)$，这样，随机时变信道可以表示为 $N_R\times N_T$ 的矩阵 $H(\tau; t)$

这样在无噪声的情况下，接收信号的矩阵表达形式为
$$
r(t) = H(\tau ;t)*s(\tau )
$$
如果是频率非选择性信道，还可表示成
$$
r(t) = H(t)s(t)
$$
更进一步，如果冲激响应的时间变化缓慢，则可简化为
$$
r(t) = Hs(t)
$$

假设从一个发射天线到另一个接收天线的每个信号经历频率非选择性瑞利衰落，还假定从发射天线到接收天线的信号传播时间差相对于符号宽度 T 是很小的，可以把一个信号区间的接收天线的等效低通接收信号表示为 

$$
{r_m}(t) = \sum\limits_{n = 1}^{{N_T}} {{s_n}{h_{mn}}g(t)}  + {z_m}(t)
$$
g(t) 是调制滤波器的冲激响应，$h_{mn}$ 是第n个发射天线到第m个接收天线之间的复值、循环零均值高斯信道增益，$s_n$ 是第 n 个发射天线发射的符号，$z_m(t)$ 是噪声

在 $N_R$ 个接收天线中每个天线的信号解调器由脉冲 g(t) 的匹配滤波器构成，其输出在每个符号末端被采样，相应的解调器输出可表示为

$$
{y_m} = \sum\limits_{n = 1}^{{N_T}} {{s_n}{h_{mn}}}  + {\eta _m}\quad y = Hs + \eta 
$$

其中的 g(t) 的能量被归一化为单位能量，$\eta_m$ 为加性高斯噪声分量。

**最大似然检测（MLD）**：每个接收天线上的加性噪声是独立同分布的awgn，所以联合条件概率密度函数 $p(y|s)$ 是高斯的，检测如下所示：
$$
\mu (s) = {\sum\limits_{m = 1}^{{N_R}} {\left| {{y_m} - \sum\limits_{n = 1}^{{N_T}} {{s_n}{h_{mn}}} } \right|} ^2}
$$
MLD 的性能最好。

**最小均方误差（MMSE）**：对接收信号 y 进行线性组合，以形成发射符号 s 的估计值 $\hat s=W^H y$，选择 W 使均方误差最小，即 $J(W) = E\left[ {{{\left\| e \right\|}^2}} \right] = E\left[ {{{\left\| {s - {W^H}y} \right\|}^2}} \right]$，最小化 J(W) 可以导出最佳加权矢量解
$$
\eqalign{
  & E\left[ {{{\left\| {s - {W^H}y} \right\|}^2}} \right] = 0 \Rightarrow {R_{yy}}W = y{s^H}  \cr 
  & {R_{yy}}\left( {{w_1},{w_2}, \cdots ,{w_n}} \right) = \left( {y \cdot {s_1},y \cdot {s_2}, \cdots ,y \cdot {s_n}} \right) \cr} 
$$
$$
{w_n} = R_{yy}^{ - 1}{r_{{s_n}y}}
$$
其中，${R_{yy}} = E\left[ {y{y^H}} \right] = H{R_{ss}}{H^H} + {N_0}I$，$R_{ss}=E[ss^H]$，$r_{s_ny}=E[s_n^*y]$，$E[\eta\eta^H]=N_0 I$

**逆信道检测（ICD）**：ICD 也通过对接收信号进行线性组合来对发射信号进行估计，如果 $N_T=N_R$，则可选择加权矩阵 W 使信道间干扰（interchannel interference）完全消除，即 $W^H=H^{-1}$，因此
$$
\hat s = {H^{ - 1}}y = s + {H^{ - 1}}\eta 
$$
如果 $N_R>N_T$，加权矩阵 W 可以选为信道矩阵的伪逆，即
$$
{W^H} = {\left( {{H^H}H} \right)^{ - 1}}{H^H}
$$

上面的三种检测都是基于接收机直到信道矩阵 H 的，若发射机和接收机都知道信道矩阵 H，还有另外一种检测技术。秩为 r 的信道矩阵 H 的奇异值分解可以表示为
$$
H = U\Sigma {V^H}
$$
这样在发射机用如下线性变换处理 $r\times 1$ 信号矢量 s：

$$
{s_v} = Vs
$$
则接收信号矢量 y 为
$$
y = H{s_v} + \eta  = HVs + \eta 
$$
在接收机用线性变换 $U^H$ 处理接收信号矢量 y，从而有

$$
\hat s = {U^H}y = {U^H}HVs + {U^H}\eta  = {U^H}U\Sigma {V^H}Vs + {U^H}\eta  = \Sigma s + {U^H}\eta 
$$
奇异值 $\{\sigma^2\}$ 对发射符号的标度影响可以在发射机利用线性变换 $V{\Sigma ^{ - 1}}$ 或者在接收机使用线性变换 ${\Sigma ^{ - 1}}{U^H}$ 进行消除。

SVD method does not exploit the signal diversity provided by the channel. This is the main disadvantage in decoupling the received signal vector y by means of the SVD.

通过频率选择性信道，则接收信号表示为

$$
{r_i}(t) = \sum\limits_{n = 1}^{{N_T}} {\int_{ - \infty }^\infty  {{h_{ij}}(\tau ;t)} {s_j}(t - \tau )d\tau }  + {z_i}(t)
$$

设第 n 个信号间隔的发射信号为 $s_j(t)=s_j(n)g(t-nT)$，代入上式可得

$$
{r_i}(t) = \sum\limits_n {\sum\limits_{j = 1}^{{N_T}} {{s_j}(n)\int_{ - \infty }^\infty  {{h_{ij}}(\tau ;t)} g(t - nT - \tau )d\tau }  + {z_i}(t)} 
$$

可以将估计值表达成

$$
\hat s(n) = {A^H}(n)r(n)
$$

The coefficients of the FIR equalizers can be adjustied adaptively，训练时，从 $N_T$ 个发射天线发射有限长的训练符号矢量来完成，训练的误差信号为

$$
e(n) = s(n) - \hat s(n) = s(n) - {A^H}(n)r(n)
$$

>线性检测器的有效分集阶数为 $N_R-N_T+1$



### Capacity of MIMO Channles



Channel Capacity：The maximum rate at which information can be transmitted over a communication channel without error, under given constraints such as bandwidth and noise level.


对于频率非选择性信道，信道容量最大时，确定信号矢量 s 的分布使接收信号和发射信号之间的互信息量最大

$$
C = \mathop {\max }\limits_{p(s)} I(s;y)
$$
信道容量的单位为 bps/Hz。当 s 是零均值、循环对称的复高斯矢量（circularly symmetric complex  gaussian random vector）时，$I(s;y)$ 最大。因此，C 仅取决于信号矢量的协方差，MIMO信道的容量为

$$
C = \mathop {\max }\limits_{tr({R_{ss}}) = {\varepsilon _s}} {\log _2}\det \left( {{I_{{N_R}}} + {1 \over {{N_0}}}H{R_{ss}}{H^H}} \right)
$$
在 $N_T$ 个发射机上的信号是统计独立的符号（每个符号的能量为 $\varepsilon_s / N_T$），信号协方差矩阵为对角阵，即

$$
{R_{ss}} = {{{\varepsilon _s}} \over {{N_t}}}{I_{{N_t}}}
$$
并且 $tr(R_{ss})=\varepsilon_s$，在这种情况下 MIMO 信道容量为

$$
{\log _2}\det \left( {{I_{{N_R}}} + {{{\varepsilon _s}} \over {{N_0}{N_T}}}H{H^H}} \right)
$$
$HH^H$ 为 Hermite 矩阵，所以有 $H{H^H} = Q\Lambda {Q^H}$，因此可以进一步表示为
$$
\eqalign{
  & C = {\log _2}\det \left( {{I_{{N_R}}} + {{{\varepsilon _s}} \over {{N_0}{N_T}}}Q\Lambda {Q^H}} \right) = {\log _2}\det \left( {{I_{{N_R}}} + {{{\varepsilon _s}} \over {{N_0}{N_T}}}{Q^H}Q\Lambda } \right)  \cr 
  &  = {\log _2}\det \left( {{I_{{N_R}}} + {{{\varepsilon _s}} \over {{N_0}{N_T}}}\Lambda } \right) = \sum\limits_{i = 1}^r {{{\log }_2}\left( {1 + {{{\varepsilon _s}} \over {{N_T}{N_0}}}{\lambda _i}} \right)}  \cr} 
$$
注意这里是 $HH^H$ 的特征值，另外一种表示方法是对 H 阵进行奇异值分解，结果为
$$
C = \sum\limits_{i = 1}^r {{{\log }_2}\left( {1 + {{{\varepsilon _s}} \over {{N_T}{N_0}}}{{\left| {{\lambda _i'}} \right|}^2}} \right)} 
$$

这样得到的结果是相同的，因为 $HH^H$ 的特征值是 $H$ 的特征值的平方

对于 SISO 信道，$\lambda_i=|h_{11}|^2$，所以

$$
{C_{SISO}} = {\log _2}\left( {1 + {{{\varepsilon _s}} \over {{N_0}}}{{\left| {{h_{11}}} \right|}^2}} \right)
$$
可以看到，MIMO信道的容量刚好等于 r 个 SISO 信道容量之和，每个 SISO 信道的发射能量为 $\varepsilon_s/N_T$ ，相应的信道增益等于特征值 $\lambda_i$。

对于 SIMO 信道，信道矩阵为 $N_R\times 1$，特征值为

$$
{\lambda _1} = \left\| h \right\|_F^2 = \sum\limits_{i = 1}^{{N_R}} {{{\left| {{h_{i1}}} \right|}^2}}
$$
SIMO 信道的容量为

$$
{C_{SIMO}} = {\log _2}\left( {1 + {{{\varepsilon _s}} \over {{N_0}}}\left\| h \right\|_F^2} \right) = {\log _2}\left( {1 + {{{\varepsilon _s}} \over {{N_0}}}\sum\limits_{i = 1}^{{N_R}} {{{\left| {{h_{i1}}} \right|}^2}} } \right)
$$

对于 MISO 信道，信道矩阵为 $N_T\times 1$，特征值为
$$
{C_{MISO}} = {\log _2}\left( {1 + {{{\varepsilon _s}} \over {{N_T}{N_0}}}\left\| h \right\|_F^2} \right) = {\log _2}\left( {1 + {{{\varepsilon _s}} \over {{N_T}{N_0}}}\sum\limits_{j = 1}^{{N_T}} {{{\left| {{h_{1j}}} \right|}^2}} } \right)
$$

lt is interesting to note that for the same ${\left\| h \right\|_F^2}$, the capacity of the SIMO channel is greater than the capacity of the MISO channel when the channel is known to the receiver only. The reason is that，under the constraint that the total transmitted energy in the two systems be identical, the energy $\varepsilon_s$ in the MISO system is split evenly among the $N_T$ transmit antennas, whereas in the SIMO system, the transmitter energy $\varepsilon_s$ is used by the single antenna. Note also that in both SIMO and MISO channels, the capacity grows logarithmically as a function of ${\left\| h \right\|_F^2}$.

+ Some certain properties of the channel matrix, such as its invertibility, are often simplified in theoretical analysis.

+ In large-scale MIMO systems, the characteristics of individual channels become less important, while the statistical properties of the overall channel matrix are more critical. 

+ When the number of antennas is very large, the fading and shadowing effects of individual channels are mitigated by the statistical distribution of the overall channel matrix. 

Ergodic capacity(遍历容量): Average the expression for the capacity of the deterministic channel over the statistics of the channel matrix. （在特征值的联合概率密度函数上进行平均）

Outage Capactiy（中断容量）: The channel conditions are highly variable and unpredictable.


只有接收机知道信道矩阵时，发射机将功率均匀分配给发射天线，如果发射机知道信道矩阵，便可以更有效地分配发射功率，从而获得更高的容量，具体原理如下：

对信道矩阵进行奇异值分解：$s=Vs_v$

$$
{y_u} = {U^H}y = {U^H}U\Sigma {V^H}V{s_v} + {U^H}n = \left[ {\matrix{
   {{\Lambda _r}} & 0  \cr 
   0 & 0  \cr 

 } } \right]{s_v} + {U^H}n
$$

第 k 个子信道 ${{{\varepsilon _s}} \over {{N_t}}}\sigma _k^2\left( {\sum\limits_{k = 1}^r {\sigma _k^2}  = {N_t}} \right)$，${\varepsilon _s} = tr({R_{ss}}) = E\left[ {{s^H}s} \right] = E\left[ {{s^H}{V^H}Vs} \right] = E\left[ {s_v^H{s_v}} \right]$

$$
\eqalign{
  & C = {\log _2}\left( {\det \left( {{I_{{N_r}}} + {1 \over {{N_0}}}H{R_{ss}}{H^H}} \right)} \right)  \cr 
  &  = {\log _2}\left( {\det \left( {{I_{{N_r}}} + {1 \over {{N_0}}}U\Lambda {V^H}VE\left[ {s_v^H{s_v}} \right]{V^H}V{\Lambda ^H}{U^H}} \right)} \right)  \cr 
  &  = {\log _2}\left( {\det \left( {{I_{{N_r}}} + {1 \over {{N_0}}}\Lambda E\left[ {s_v^H{s_v}} \right]{\Lambda ^H}} \right)} \right)  \cr 
  &  = \sum\limits_{k = 1}^r {{{\log }_2}\left( {{I_{{N_r}}} + {{{\varepsilon _s}\sigma _k^2} \over {{N_0}{N_T}}}{{\left| {{\lambda _k}} \right|}^2}} \right)}  \cr} 
$$

在第 k 个信道上的发射能量为 $\varepsilon \sigma^2_{k}/N_T$，发射机在 $N_T$ 个天线上分配能量使得 C 最大，解决该问题可使用注水算法，即根据比值 $N_0/|\lambda_k|^2$（注意这里的 $\lambda_k$ 是信道矩阵 H 的特征值），将较多功率分配给具有低噪声功率的子信道，将较少功率分配给具有高噪声功率的子信道。
